



<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link rel="icon" href="images/favicon.ico" type="image/x-icon">

  <title>ãƒ¬ã‚·ãƒ”æ¤œç´¢</title>


		<div style="text-align: right;">
			æœ€çµ‚æ›´æ–°æ—¥ã€€20:02 --2026/01/07 <br>
			
			æ±ºå®šå›é¿ã®æ³•å‰‡ã‚’åŠ å‘³ã—ã€é¸æŠè‚¢ã‚’æ¸›ã‚‰ã™<br>
			
			<a href="update.html">ãƒ­ã‚°</a>
			<font size = 6>
			</font>
		</div>


<script>
  // èª­ã¿è¾¼ã‚€ãŸã³ã«ã€Œ?v=ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ã€ã‚’ä»˜ã‘ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹
  const script = document.createElement('script');
  script.src = 'recipes_data.js?v=' + new Date().getTime();
  document.head.appendChild(script);
</script>


<script src="recipes_data.js"></script>
<script>


function createNewRecipe() {
    // 1. IDã‚’æ•°å€¤åŒ–ã—ã€900ä»¥ä¸Šã®ã€Œãƒ†ã‚¹ãƒˆç”¨å¤–ã‚Œå€¤ã€ã‚’é™¤å¤–ã—ã¦æœ€å¤§å€¤ã‚’æ¢ã™
    const validIds = RECIPE_LIST
        .map(r => parseInt(r.id))
        .filter(id => id < 900); // 900ç•ªå°ã¯å¤–ã‚Œå€¤ã¨ã—ã¦ç„¡è¦–ã™ã‚‹

    const lastId = validIds.length > 0 ? Math.max(...validIds) : 0;
    const nextId = String(lastId + 1).padStart(3, '0');

    const formBase = "https://docs.google.com/forms/d/e/1FAIpQLSeq_8AMcuIM-8O50UnBT1Dp-VBzQBhpE1NI1hI10CpieTcnIQ/viewform";
    const query = new URLSearchParams();
    
    query.append("entry.834953376", nextId);
    
    const message = `æ–°è¦ãƒ¬ã‚·ãƒ”ï¼ˆID: ${nextId}ï¼‰ã‚’ä½œæˆã—ã¾ã™ã‹ï¼Ÿ\nï¼ˆç¾åœ¨ã®æœ€å¤§å€¤ ${lastId} ç•ªã«ç¶šãç•ªå·ã§ã™ï¼‰`;
    if (window.confirm(message)) {
        window.location.href = `${formBase}?${query.toString()}`;
    }
}




// --- 1. è©³ç´°è¡¨ç¤ºã¨é·ç§»ã®ãƒ­ã‚¸ãƒƒã‚¯ ---

function goToRecipeDetail(recipeId) {
    const recipe = RECIPE_LIST.find(r => r.id === recipeId);
    // ææ–™ã¨ä½œã‚Šæ–¹ãŒä¸¡æ–¹ã‚ã‚‹ã‹åˆ¤å®š
    const hasContent = recipe && 
                       recipe.materials && recipe.materials.length > 0 && 
                       recipe.methods && recipe.methods.length > 0;

    if (hasContent) {
        showMeTheRecipe(recipe); 
    } else {
        const message = `ã€Œ${recipe ? recipe.name : "ã“ã®ãƒ¬ã‚·ãƒ”"}ã€ã®å†…å®¹ã¯ã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\nãƒ¬ã‚·ãƒ”æä¾›ãƒ•ã‚©ãƒ¼ãƒ ã¸ç§»å‹•ã—ã¾ã™ã‹ï¼Ÿ`;
        if (window.confirm(message)) {
            const formBase = "https://docs.google.com/forms/d/e/1FAIpQLSeq_8AMcuIM-8O50UnBT1Dp-VBzQBhpE1NI1hI10CpieTcnIQ/viewform";
            const idEntry = "entry.834953376=" + recipeId;
            const nameEntry = "&entry.934654902=" + encodeURIComponent(recipe ? recipe.name : "ä¸æ˜ãªãƒ¬ã‚·ãƒ”");
            window.location.href = formBase + "?" + idEntry + nameEntry;
        }
    }
}

function showMeTheRecipe(recipe) {
    // æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éš ã™
    const mainElements = ['h1', '.search-box', '#recipeTable', '#materialButtons', '.sort-buttons', '#materialSection'];
    mainElements.forEach(selector => {
        const el = document.querySelector(selector);
        if (el) el.style.display = 'none';
    });

    let detailArea = document.getElementById('recipeDetailArea');
    if (!detailArea) {
        detailArea = document.createElement('div');
        detailArea.id = 'recipeDetailArea';
        document.body.appendChild(detailArea);
    }
    detailArea.style.display = 'block';

    detailArea.innerHTML = `
        <div style="padding: 20px; max-width: 800px; margin: auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <button onclick="location.reload()" style="padding: 10px 20px; cursor: pointer;">â† æ¤œç´¢ã«æˆ»ã‚‹</button>
            <button onclick="editThisRecipe('${recipe.id}')" style="float:right; background:#ffcc66; padding: 10px 20px; border:none; border-radius:4px; cursor: pointer; font-weight:bold;">ç·¨é›†ã™ã‚‹</button>
            
            <h1 style="text-align:left; margin-top:20px;">${recipe.name}</h1>
            <img src="images/${recipe.id}.jpg" alt="${recipe.name}" onerror="this.src='images/NO_NAME.jpg'" style="max-width:300px; width:100%; height:auto; display:block; margin:20px auto; border-radius:8px;">

            <table class="recipe-table" style="width: 100%; border-collapse: collapse; margin-top: 20px;">
                <thead>
                    <tr><th style="background:#f0f0f0; text-align:left; padding:10px; border-bottom:2px solid #5cb85c; font-size:1.2em;">ææ–™</th></tr>
                </thead>
                <tbody>
                    ${(recipe.materials || []).map(m => `<tr><td style="padding:12px; border-bottom:1px dotted #ccc;">${m}</td></tr>`).join('')}
                </tbody>
                <thead>
                    <tr><th style="background:#f0f0f0; text-align:left; padding:10px; border-bottom:2px solid #5cb85c; border-top:30px solid transparent; font-size:1.2em;">ä½œã‚Šæ–¹</th></tr>
                </thead>
                <tbody>
                    ${(recipe.methods || []).map(step => `<tr><td style="padding:12px; border-bottom:1px dotted #ccc;">${step}</td></tr>`).join('')}
                </tbody>
            </table>
        </div>
    `;
    window.scrollTo(0, 0);
}

function editThisRecipe(recipeId) {
    const recipe = RECIPE_LIST.find(r => r.id === recipeId);
    if (!recipe) return;

    // ç·¨é›†å‰ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
    const message = `ã€Œ${recipe.name}ã€ã®å†…å®¹ã‚’ç·¨é›†ã—ã¾ã™ã‹ï¼Ÿ\n(Googleãƒ•ã‚©ãƒ¼ãƒ ã¸ç§»å‹•ã—ã¾ã™)`;
    if (!window.confirm(message)) {
        return; // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸå ´åˆã¯ä½•ã‚‚ã—ãªã„
    }

    const formBase = "https://docs.google.com/forms/d/e/1FAIpQLSeq_8AMcuIM-8O50UnBT1Dp-VBzQBhpE1NI1hI10CpieTcnIQ/viewform";
    const query = new URLSearchParams();
    
    query.append("entry.834953376", recipe.id);
    query.append("entry.934654902", recipe.name);
    query.append("entry.1179458958", (recipe.materials || []).join("\n"));
    query.append("entry.811488190", (recipe.methods || []).join("\n"));

    window.location.href = `${formBase}?${query.toString()}`;
}



function showMeTheRecipe(recipe) {
    // æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆæ¤œç´¢çª“ã€ãƒ†ãƒ¼ãƒ–ãƒ«ã€ãã—ã¦ææ–™ãƒœã‚¿ãƒ³ã™ã¹ã¦ï¼‰ã‚’éš ã™
    // IDæŒ‡å®š(#)ã ã‘ã§ãªãã€ã™ã¹ã¦ã® materialButtons ã‚’å¯¾è±¡ã«ã—ã¾ã™
    const mainSelectors = ['h1', '.search-box', '#recipeTable', '.sort-buttons', '#materialSection'];
    mainSelectors.forEach(selector => {
        const el = document.querySelector(selector);
        if (el) el.style.display = 'none';
    });

    // IDãŒé‡è¤‡ã—ã¦ã„ã‚‹ã€Œææ–™ãƒœã‚¿ãƒ³ã€ã‚’ã™ã¹ã¦éè¡¨ç¤ºã«ã™ã‚‹
    document.querySelectorAll('#materialButtons').forEach(el => {
        el.style.display = 'none';
    });

    let detailArea = document.getElementById('recipeDetailArea');
    if (!detailArea) {
        detailArea = document.createElement('div');
        detailArea.id = 'recipeDetailArea';
        document.body.appendChild(detailArea);
    }
    detailArea.style.display = 'block';

    // ï¼ˆä»¥ä¸‹ã€innerHTML ã®ä»£å…¥å‡¦ç†ã¸ç¶šã...ï¼‰

    // ä¿®æ­£ãƒã‚¤ãƒ³ãƒˆï¼šsrcå±æ€§ã‚’ãƒãƒƒã‚¯ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€
    detailArea.innerHTML = `
        <div style="padding: 20px; max-width: 800px; margin: auto; background: white; border-radius: 8px;">
            <button onclick="location.reload()">â† æ¤œç´¢ã«æˆ»ã‚‹</button>
            <button onclick="editThisRecipe('${recipe.id}')" style="float:right; background:#ffcc66;">ç·¨é›†ã™ã‚‹</button>
            
            <h1>${recipe.name}</h1>
            <img src="images/${recipe.id}.jpg" alt="${recipe.name}" onerror="this.src='images/NO_NAME.jpg'" style="max-width:300px; width:100%; display:block; margin:20px auto;">

            <table class="recipe-table" style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr><th style="background:#f0f0f0; padding:10px; border-bottom:2px solid #5cb85c;">ææ–™</th></tr>
                </thead>
                <tbody>
                    ${(recipe.materials || []).map(m => `<tr><td style="padding:12px; border-bottom:1px dotted #ccc;">${m}</td></tr>`).join('')}
                </tbody>
                <thead>
                    <tr><th style="background:#f0f0f0; padding:10px; border-bottom:2px solid #5cb85c; border-top:30px solid transparent;">ä½œã‚Šæ–¹</th></tr>
                </thead>
                <tbody>
                    ${(recipe.methods || []).map(step => `<tr><td style="padding:12px; border-bottom:1px dotted #ccc;">${step}</td></tr>`).join('')}
                </tbody>
            </table>
        </div>
    `;
    window.scrollTo(0, 0);
}
</script>




	<script>

	
	  function checkImageAndSet(id, path) {
		const img = new Image();
		img.onload = function() {
		  document.getElementById(id).src = path;
		};
		img.onerror = function() {
		  document.getElementById(id).src = 'images/NO_NAME.jpg';
		};
		img.src = path;
	  }

		document.addEventListener('DOMContentLoaded', () => {
		  if (typeof RECIPE_LIST !== 'undefined') {
			// 1. ã¾ãšãƒ‡ãƒ¼ã‚¿ã‹ã‚‰HTMLï¼ˆã‚«ãƒ¼ãƒ‰ï¼‰ã‚’ç”Ÿæˆã™ã‚‹
			renderRecipes();           

			// 2. ã‚«ãƒ¼ãƒ‰ãŒã§ãã¦ã‹ã‚‰ã€ãƒœã‚¿ãƒ³ã®æ•°å­—ã‚’è¨ˆç®—ã—ãŸã‚Šæ¤œç´¢ã‚’æœ‰åŠ¹ã«ã™ã‚‹
			generateMaterialButtons(); 
			filterAndSortRecipes();    
			
			if (typeof updateButtons === 'function') {
			  updateButtons();
			}
		  } else {
			console.error("recipes_data.js ãŒèª­ã¿è¾¼ã‚ã¦ã„ã¾ã›ã‚“");
		  }
		});
			  
	  
	  
	  
	  
	  
	  
	</script>



<style>
/* -------------------- 1. ãƒªã‚»ãƒƒãƒˆã¨åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« -------------------- */
* {
  box-sizing: border-box;
}

body {
  font-family: "Segoe UI", "Hiragino Kaku Gothic ProN", sans-serif;
  background-color: #f9f9f9;
  margin: 0;
  padding: 20px;
  color: #333;
  font-size: 18px; /* PCå‘ã‘åŸºæœ¬ã‚µã‚¤ã‚º */
}

h1 {
  text-align: center;
  margin-bottom: 30px;
  color: #444;
  font-size: 2em;
}




/* è¿½åŠ ã—ãŸææ–™ãƒœã‚¿ãƒ³ã®å°‚ç”¨ãƒ‡ã‚¶ã‚¤ãƒ³ */
#materialButtons button:not(#favoriteFilterBtn) {
  background: #ffffff;
  border: 1px solid #ddd;
  border-radius: 20px; /* ä¸¸ã¿ã‚’å‡ºã—ã¦ã‚¿ã‚°é¢¨ã« */
  padding: 6px 15px;
  margin: 4px;
  font-size: 14px;
  color: #555;
  box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  transition: all 0.3s ease; /* å‹•ãã‚’ãªã‚ã‚‰ã‹ã« */
}

/* ãƒã‚¦ã‚¹ã‚’ä¹—ã›ãŸæ™‚ï¼ˆã¡ã‚‡ã£ã¨æµ®ãä¸ŠãŒã‚‹ï¼‰ */
#materialButtons button:not(#favoriteFilterBtn):hover {
  background: #f0f0f0;
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  border-color: #bbb;
}

/* é¸æŠã•ã‚ŒãŸæ™‚ï¼ˆãƒ‘ãƒƒã¨ç›®ã‚’å¼•ãè‰²ã«ï¼‰ */
#materialButtons button.selected {
  background: #ffcc66 !important;
  color: #333 !important;
  border-color: #ffa500 !important;
  font-weight: bold;
}




/* -------------------- 2. æ±ç”¨ãƒœã‚¿ãƒ³ãƒ»ãƒ•ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ã‚¤ãƒ« (PCå‘ã‘åŸºæœ¬) -------------------- */

/* æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
.search-box {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: center;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 20px;
}

/* ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› */
input[type="text"] {
  padding: 12px;
  width: 100%;
  max-width: 600px;
  border: 1px solid #ccc;
  border-radius: 4px;
  font-size: 1em;
}

/* æ±ç”¨ãƒœã‚¿ãƒ³ã®åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
button {
  padding: 10px 16px;
  border: none;
  border-radius: 4px;
  background-color: #eee;
  cursor: pointer;
  transition: background-color 0.2s;
  font-size: 1em;
}

button:hover {
  background-color: #ddd;
}

/* -------------------- 3. ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆç”»åƒä»˜ã2åˆ—ã‚«ãƒ¼ãƒ‰ï¼‰ ã“ã“ä½™è¨ˆãªå¤‰æ›´ã‚’ã™ã‚‹ã¨æ¤œç´¢ãŒãŠã‹ã—ããªã‚‹ã€€ãƒãƒ¼ã«å…¥ã‚ŒãŸæ–‡å­—ã®å«ã‚€ã‚‚ã®ãŒæ¶ˆãˆã‚‹ã€€ã¨ã‹ãŒèµ·ãã‚‹ã€€æ³¨æ„ -------------------- */
#recipeTable { display: block; width: 100%; }
#recipeTable thead { display: none; }

#recipeTable tbody {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(calc(50% - 15px), 1fr));
  gap: 20px;
  padding: 15px 0;
}

#recipeTable tr {
  display: flex; /* ç¸¦ä¸¦ã³ã«ã™ã‚‹ãŸã‚flexã«å¤‰æ›´ */
  flex-direction: column;
  background: #fff;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
  position: relative;
  overflow: hidden; /* ç”»åƒã®è§’ã‚’ä¸¸ã‚ã‚‹ãŸã‚ */
  border: 1px solid #eee;
  transition: transform 0.2s;
  cursor: pointer;
}

#recipeTable tr:hover { transform: translateY(-5px); }

/* --- ç”»åƒï¼ˆ5åˆ—ç›®ï¼‰ã‚’ä¸€ç•ªä¸Šã« --- */
#recipeTable td:nth-child(5) {
  display: block !important; /* è¡¨ç¤ºã•ã›ã‚‹ */
  order: -1; /* ä¸€ç•ªä¸Šã¸ */
  width: 100%;
  height: 180px;
}
#recipeTable td img {
  width: 100%;
  height: 100%;
  object-fit: cover; /* æ ã«åˆã‚ã›ã¦åˆ‡ã‚ŠæŠœã */
}

/* æ–™ç†åã¨ãŠæ°—ã«å…¥ã‚Šç”¨ã®ã‚³ãƒ³ãƒ†ãƒŠï¼ˆtdã‚’èª¿æ•´ï¼‰ */
#recipeTable td:nth-child(2) {
  padding: 15px;
}
.recipe-name {
  font-weight: bold;
  font-size: 1.2em;
  color: #333;
  text-decoration: none;
}
.recipe-name a { color: inherit; text-decoration: none; }

/* IDãƒãƒƒã‚¸ */
#recipeTable td:nth-child(1) {
  position: absolute; top: 10px; left: 10px;
  background: rgba(0,0,0,0.6); color: #fff;
  padding: 2px 8px; border-radius: 4px; font-size: 0.7em;
  z-index: 2;
}

/* ãŠæ°—ã«å…¥ã‚Š */
#recipeTable td:nth-child(6) {
  position: absolute; top: 190px; right: 15px; /* ç”»åƒã®ä¸‹ã‚ãŸã‚Š */
  font-size: 1.5em;
}

/* --- JSç”¨ã®éš ã—è¨­å®šï¼ˆçµ¶å¯¾ã«æ¶ˆã•ãªã„ï¼ï¼‰ --- */
#recipeTable td:nth-child(3), #recipeTable td:nth-child(4),
#recipeTable td:nth-child(7), .hidden-reading {
  visibility: hidden; position: absolute; width: 0; height: 0;
}

#recipeTable tr.hidden { display: none !important; }

@media (max-width: 600px) {
  #recipeTable tbody { grid-template-columns: 1fr; }
}


/* -------------------- 4. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¨ã‚½ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ -------------------- */

/* ææ–™ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
#materialButtons {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  justify-content: flex-start;
  margin-bottom: 20px;
}

/* ã‚½ãƒ¼ãƒˆãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
.sort-buttons {
  margin-bottom: 10px;
  display: flex;
  gap: 8px;
}

/* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒ†ãƒŠ */
.filter-buttons {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 8px;
  justify-content: center;
  margin-bottom: 20px;
}

/* -------------------- 5. ãƒœã‚¿ãƒ³ã¨è¦ç´ ã®çŠ¶æ…‹ã‚¹ã‚¿ã‚¤ãƒ« -------------------- */

/* ä¸¦ã¹æ›¿ãˆãƒœã‚¿ãƒ³ï¼ˆæœªé¸æŠï¼‰ */
.sort-buttons button {
  border: 2px solid white;
  background-color: #fff;
  color: #333;
  padding: 10px 16px;
  border-radius: 4px;
  font-size: 16px;
  transition: border-color 0.2s;
}

.sort-buttons button:hover {
  border-color: darkred;
}

/* é¸æŠä¸­ã®ãƒœã‚¿ãƒ³ï¼ˆææ–™ã€ã‚½ãƒ¼ãƒˆï¼‰ */
.filter-buttons button.selected,
#favoriteFilterBtn.selected,
.sort-buttons button.selected,
#materialButtons button.selected {
  background-color: #ffcc66;
  color: #333;
  font-weight: bold;
  border: 1px solid #999;
  box-shadow: 0 0 5px rgba(0 0 0 / 20%);
}

/* ææ–™ãƒ†ã‚­ã‚¹ãƒˆã®é¸æŠçŠ¶æ…‹ */
.material.selected-material {
  color: #0077cc;
  font-weight: bold;
  background-color: #e0f0ff;
  padding: 2px 4px;
  border-radius: 3px;
}

/* ä¸è¶³ã—ã¦ã„ã‚‹ææ–™ãƒ†ã‚­ã‚¹ãƒˆ */
.material.missing {
  color: red;
  font-weight: bold;
  background-color: #ffe5e5;
  padding: 2px 4px;
  border-radius: 3px;
}

.match-rate {
  font-size: 0.9em;
  color: #666;
}

/* ä¸è¶³ææ–™ã®ä¸€è‡´åº¦æ¬„è¡¨ç¤º */
.match-rate .missing {
    color: red;
    font-weight: bold;
    display: inline-block;
    margin-top: 4px;
}

/* ä¸€è‡´åº¦100%ã®è¡Œ */
#recipeTable tr.perfect-match {
  background-color: #fff8dc;
  box-shadow: inset 0 0 4px rgb(255 204 102 / 60%);
}

/* -------------------- 6. è©³ç´°/ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ (materialSection) -------------------- */

#materialSection summary {
  font-size: 1.1em;
  font-weight: bold;
  background-color: #f0f0f0;
  color: #333;
  padding: 12px 16px;
  border-radius: 6px;
  border: 1px solid #999;
  cursor: pointer;
  box-shadow: 0 0 4px rgb(0 0 0 / 10%);
  transition: background-color 0.2s;
  list-style: none;
  display: inline-block;
  margin-bottom: 30px;
}

#materialSection[open] {
  border: 2px solid #ffcc66;
  border-radius: 6px;
  padding: 10px;
  background-color: #fff8dc;
  margin-bottom: 20px;
}

/* -------------------- 7. ãƒˆãƒƒãƒ—ãƒ»ãƒœãƒˆãƒ ãƒœã‚¿ãƒ³ -------------------- */

#backToTop,
#scrollToBottom {
  position: fixed;
  right: 30px;
  padding: 16px 24px;
  font-size: 18px;
  background-color: #333;
  color: #fff;
  border: none;
  border-radius: 0;
  cursor: pointer;
  display: none;
  z-index: 1000;
  box-shadow: 0 2px 6px rgb(0 0 0 / 30%);
  white-space: nowrap;
}

#backToTop {
  bottom: 30px;
}

#scrollToBottom {
  bottom: 90px;
}

/* -------------------- 8. ã‚¹ãƒãƒ›å‘ã‘èª¿æ•´ (max-width: 768px) -------------------- */

/* ã“ã‚ŒãŒä¸€ç•ªæœ€å¾Œã«èª­ã¿è¾¼ã¾ã‚Œã‚‹ã“ã¨ã§ã€ç¢ºå®Ÿã«ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºã‚’ä¸Šæ›¸ãã—ã¾ã™ */
@media (max-width: 768px) {
  body {
    font-size: 16px; /* åŸºæœ¬ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’å°ã•ã */
    padding: 10px;
  }

  h1 {
    font-size: 1.5em;
  }

  /* æ¤œç´¢çª“ */
  input[type="text"] {
    padding: 16px;
    font-size: 1.1em;
    width: 90%;
    max-width: 100%;
  }
  
  .search-box {
    flex-direction: column;
    align-items: center;
  }
  
  .recipe-name {
    max-width: 90vw; /* ç”»é¢å¹…ã„ã£ã±ã„ã«åºƒã’ã‚‹ */
  }
  
  table, th, td {
    font-size: 0.85em;
  }

  /* â†“â†“â†“ å…¨ã¦ã®ãƒœã‚¿ãƒ³ã‚’å°ã•ãã™ã‚‹ãƒ¢ãƒã‚¤ãƒ«è¨­å®š â†“â†“â†“ */

  /* ææ–™ãƒœã‚¿ãƒ³ */
  #materialButtons button,
  #materialButtons button.selected,
  #materialButtons button.frequent {
    padding: 5px 8px;
    font-size: 11px;
    line-height: 1;
  }

  /* ã‚½ãƒ¼ãƒˆãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ */
  .sort-buttons button,
  .filter-buttons button,
  #favoriteFilterBtn {
    padding: 5px 8px;
    font-size: 11px;
  }
  
  /* ãƒˆãƒƒãƒ—/ãƒœãƒˆãƒ ãƒœã‚¿ãƒ³ */
  #backToTop,
  #scrollToBottom {
    padding: 10px 16px;
    font-size: 14px;
    right: 15px;
  }
  #scrollToBottom {
    bottom: 60px;
  }
  
  /* â†‘â†‘â†‘ ãƒ¢ãƒã‚¤ãƒ«è¨­å®šã“ã“ã¾ã§ â†‘â†‘â†‘ */

  /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã®é…ç½®ï¼ˆã‚¹ãƒãƒ›å‘ã‘ï¼‰ */
  .filter-buttons {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 8px;
    /* gridè¨­å®šã‚’flexã§ä¸Šæ›¸ãã—ã¦ã€ã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã« */
  }
}
</style>
  
  
  
</head>


<body>








<h1>ãƒ¬ã‚·ãƒ”æ¤œç´¢</h1>

<button id="backToTop">â†‘ ãƒˆãƒƒãƒ—ã¸</button>
<button id="scrollToBottom">â†“ ä¸€ç•ªä¸‹ã¸</button>

<div class="sort-buttons">
  <button id="sortRecipesById">IDé †</button>
  <button id="sortRecipesByName">æ–™ç†åé †</button>
</div>




<div class="search-box">
  <input type="text" id="keyword" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢">
  <button>ğŸ”</button>
  <button onclick="clearFilters()">æ¡ä»¶ã‚¯ãƒªã‚¢</button>
</div>

<button onclick="createNewRecipe()" style="background: #5cb85c; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; font-weight: bold; margin-bottom: 20px;">
    ï¼‹ æ–°è¦ãƒ¬ã‚·ãƒ”ã‚’è¿½åŠ 
</button>

<details id="materialSection" hidden>
  <summary>ãƒ‡ãƒãƒƒã‚°ç”¨å€‹æ•°ç¢ºèª</summary>

  <div id="sortButtons" class="sort-buttons">
    <button onclick="setMaterialSort('name')">åå‰é †ï¼ˆæ¼¢å­—éå¯¾å¿œï¼‰</button>
    <button onclick="setMaterialSort('count')">å‡ºç¾æ•°é †</button>
  </div>

  <div id="materialButtons" class="filter-buttons"></div>
</details>



<div class="filter-buttons" id="materialButtons">
  <button id="favoriteFilterBtn">ã¨ã‚Šã‚ãˆãšã“ã‚Œâ˜…</button>
</div>

<table id="recipeTable">
  <thead>
    <tr>
      <th>ID</th>
      <th>æ–™ç†å</th>
      <th>ææ–™ãƒ»åˆ†é‡</th>
      <th>ã‚¸ãƒ£ãƒ³ãƒ«</th>
      <th>ç”»åƒ</th>
      <th>ã‚ˆãå‡ºã‚‹</th>
      <th>ä¸€è‡´åº¦</th>
    </tr>
  </thead>


<tbody>
	</tbody>




</table>


<script>
  let materialSortMode = 'count'; // ææ–™ãƒœã‚¿ãƒ³ã®ä¸¦ã³é †ï¼ˆå‡ºç¾å›æ•° or åå‰ï¼‰
  let currentSortMode = 'id';      // ãƒ¬ã‚·ãƒ”ã®ä¸¦ã³é †ï¼ˆid or nameï¼‰

  function normalizeMaterialName(text) {
    return text
      .split(':')[0]
      .replace(/^[^\p{Script=Hiragana}\p{Script=Katakana}\p{Script=Han}]+/gu, '')
      .trim();
  }

  const selectedMaterials = new Set();
  let favoriteFilterActive = false;

  function setMaterialSort(mode) {
    materialSortMode = mode;
    generateMaterialButtons();
  }

  function generateMaterialButtons() {
    const materialCount = {};
    document.querySelectorAll('#recipeTable .material').forEach(span => {
      const raw = normalizeMaterialName(span.textContent);

      if (raw !== '') {
        materialCount[raw] = (materialCount[raw] || 0) + 1;
      }
    });

    const materials = Object.keys(materialCount);

    let sortedMaterials;
    if (materialSortMode === 'name') {
      sortedMaterials = materials.sort((a, b) => a.localeCompare(b, 'ja'));
    } else {
      sortedMaterials = materials.sort((a, b) => {
        const diff = materialCount[b] - materialCount[a];
        return diff !== 0 ? diff : a.localeCompare(b, 'ja');
      });
    }

    const topMaterials = Object.entries(materialCount)
      .sort((a, b) => b[1] - a[1])
      .slice(0, 10)
      .map(entry => entry[0]);

    const container = document.getElementById('materialButtons');
    container.innerHTML = '';

    sortedMaterials.forEach(mat => {
      const btn = document.createElement('button');
      btn.textContent = `${mat} (${materialCount[mat]})`;
      btn.dataset.material = mat;
      btn.onclick = () => toggleMaterial(btn, mat);
      if (topMaterials.includes(mat)) btn.classList.add('frequent');
      if (selectedMaterials.has(mat)) btn.classList.add('selected');
      container.appendChild(btn);
    });

    // ğŸ”´ ä¿®æ­£ç‚¹1: ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®šã‚’ã“ã“ã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸã€‚
    // ãã®ä»£ã‚ã‚Šã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æœ€å¾Œã«ä¸€åº¦ã ã‘è¨­å®šã•ã‚Œã¾ã™ã€‚
  }

  function toggleMaterial(button, mat) {
    if (selectedMaterials.has(mat)) {
      selectedMaterials.delete(mat);
      button.classList.remove('selected');
    } else {
      selectedMaterials.add(mat);
      button.classList.add('selected');
    }
    generateMaterialButtons();
    filterAndSortRecipes();
  }

  function filterAndSortRecipes() {
    const keyword = document.getElementById('keyword').value.trim().toLowerCase();
		// ã€Œdocumentã€ã§ã¯ãªãã€Œtbodyã€ã‹ã‚‰æ¢ã™ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™
	// ğŸŸ¢ 844è¡Œç›®ã‚ãŸã‚Šã‚’ã“ã‚Œã«æ›¸ãæ›ãˆ
const rows = Array.from(document.querySelectorAll('#recipeTable tbody tr'));
    const filteredRows = [];

    rows.forEach(row => {
      const name = row.cells[1].textContent.toLowerCase();
      const reading = row.querySelector('.hidden-reading')?.textContent.toLowerCase() || '';
      const genreRaw = row.cells[3].dataset.genre?.toLowerCase() || row.cells[3].textContent.toLowerCase();
      const genreList = genreRaw.split(',').map(g => g.trim());
      const favorite = row.cells[5].textContent.trim();
      const materialSpans = row.querySelectorAll('.material');
      const materialList = Array.from(materialSpans).map(span => normalizeMaterialName(span.textContent));

      const matched = materialList.filter(m => selectedMaterials.has(m));
      const missing = Array.from(selectedMaterials).filter(m => !materialList.includes(m));
      const matchRateCell = row.querySelector('.match-rate');
      matchRateCell.innerHTML = selectedMaterials.size > 0
        ? `${matched.length}/${selectedMaterials.size} (${Math.round((matched.length / selectedMaterials.size) * 100)}%)`
        : '';
      if (missing.length > 0) {
        matchRateCell.innerHTML += `<br><span class="missing">ä¸è¦: ${missing.join(', ')}</span>`;
      }

      materialSpans.forEach(span => {
        const matName = normalizeMaterialName(span.textContent);

        span.classList.toggle('selected-material', selectedMaterials.has(matName));
        span.classList.remove('missing');
      });

      const genreMatch = genreList.some(g => g.includes(keyword));
      const keywordMatch = keyword === '' || name.includes(keyword) || genreMatch || materialList.some(m => m.includes(keyword)) || reading.includes(keyword);
      const materialMatch = selectedMaterials.size === 0 || matched.length > 0;
      const favoriteMatch = !favoriteFilterActive || favorite === 'â˜…';

      const shouldShow = keywordMatch && materialMatch && favoriteMatch;
      row.classList.toggle('hidden', !shouldShow);

      if (shouldShow) {
        row.dataset.matchScore = matched.length;

        // ä¸€è‡´åº¦100%ãªã‚‰ã‚¯ãƒ©ã‚¹è¿½åŠ 
        if (selectedMaterials.size > 0 && matched.length === selectedMaterials.size) {
          row.classList.add('perfect-match');
        } else {
          row.classList.remove('perfect-match');
        }

        filteredRows.push(row);
      }

    });

    const tbody = document.querySelector('#recipeTable tbody');
    if (selectedMaterials.size > 0) {
      filteredRows.sort((a, b) => b.dataset.matchScore - a.dataset.matchScore);
    } else if (currentSortMode === 'name') {
      filteredRows.sort((a, b) => {
        const nameA = a.querySelector('.hidden-reading')?.textContent.trim() || '';
        const nameB = b.querySelector('.hidden-reading')?.textContent.trim() || '';
        return nameA.localeCompare(nameB, 'ja');
      });
    } else {
      filteredRows.sort((a, b) => a.dataset.id - b.dataset.id);
    }

    filteredRows.forEach(row => tbody.appendChild(row));
  }

  document.getElementById('keyword').addEventListener('input', filterAndSortRecipes);

  function clearFilters() {
    selectedMaterials.clear();
    document.getElementById('keyword').value = '';
    document.querySelectorAll('.filter-buttons button').forEach(btn => btn.classList.remove('selected'));
    favoriteFilterActive = false;
    document.getElementById('favoriteFilterBtn').classList.remove('selected');
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    document.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
    filterAndSortRecipes();
  }



  const backToTopBtn = document.getElementById('backToTop');
  const scrollToBottomBtn = document.getElementById('scrollToBottom');

  window.addEventListener('scroll', () => {
    const scrollY = window.scrollY;
    const windowHeight = window.innerHeight;
    const documentHeight = document.body.scrollHeight;
    backToTopBtn.style.display = scrollY > 200 ? 'block' : 'none';
    scrollToBottomBtn.style.display = scrollY + windowHeight < documentHeight - 200 ? 'block' : 'none';
  });

  backToTopBtn.addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
  });

  scrollToBottomBtn.addEventListener('click', () => {
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
  });

  document.querySelectorAll('.sort-buttons button').forEach(btn => {
    btn.addEventListener('click', () => {
      // å…¨ãƒœã‚¿ãƒ³ã‹ã‚‰ .selected ã‚’å¤–ã™
      document.querySelectorAll('.sort-buttons button').forEach(b => b.classList.remove('selected'));

      // æŠ¼ã—ãŸãƒœã‚¿ãƒ³ã« .selected ã‚’ä»˜ã‘ã‚‹
      btn.classList.add('selected');

      // ä¸¦ã³æ›¿ãˆãƒ¢ãƒ¼ãƒ‰ã‚’æ›´æ–°
      if (btn.id === 'sortRecipesById') {
        currentSortMode = 'id';
      } else if (btn.id === 'sortRecipesByName') {
        currentSortMode = 'name';
      } else if (btn.id === 'sortMaterialsByName') {
        materialSortMode = 'name';
      } else if (btn.id === 'sortMaterialsByCount') {
        materialSortMode = 'count';
      }

      filterAndSortRecipes();
      generateMaterialButtons();
    });
  });

  document.querySelectorAll('.filter-buttons button').forEach(button => {
    button.addEventListener("click", () => {
      button.classList.toggle("selected");
      filterAndSortRecipes();
    });
  });

  // ğŸ”´ ä¿®æ­£ç‚¹2: ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®šã‚’ã“ã“ã«ç§»å‹•ã—ã¾ã—ãŸã€‚
  // ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®åˆæœŸåŒ–æ™‚ã€ä¸€åº¦ã ã‘å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
  const favoriteFilterBtn = document.getElementById('favoriteFilterBtn');
  favoriteFilterBtn.addEventListener('click', () => {
      favoriteFilterActive = !favoriteFilterActive;
      favoriteFilterBtn.classList.toggle('selected', favoriteFilterActive);
      filterAndSortRecipes();
  });
  
  



// ã€ä¿®æ­£ç‰ˆã€‘ã‚ãªãŸã®å‡¦ç†ã‚’ã™ã¹ã¦ç¶­æŒã—ãŸã‚³ãƒ¼ãƒ‰
let updateButtonsOutside; 

function initFixedMaterialButtons() {
    const containers = document.querySelectorAll('#materialButtons');
    const target = containers[1]; 
    if (!target) return;

    const materialList = ['è±šè‚‰', 'é¶è‚‰', 'ã²ãè‚‰', 'ç‰ã­ã', 'ã˜ã‚ƒãŒã„ã‚‚'];
    const rows = Array.from(document.querySelectorAll('#recipeTable tbody tr'));

    // ğŸŸ¢ ä¿®æ­£ç‚¹ï¼šinnerHTML = '' ã‚’ã‚„ã‚ã€ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ä»¥å¤–ã®å¤ã„ææ–™ãƒœã‚¿ãƒ³ã ã‘ã‚’æ¶ˆå»ã™ã‚‹
    const oldButtons = target.querySelectorAll('button:not(#favoriteFilterBtn)');
    oldButtons.forEach(btn => btn.remove());

    const updateButtons = () => {
      const visibleRows = Array.from(rows).filter(row => !row.classList.contains('hidden'));
      const selectedButtons = target.querySelectorAll('button.selected');
      const scanRows = selectedButtons.length === 0 ? Array.from(rows) : visibleRows;

      target.querySelectorAll('button:not(#favoriteFilterBtn)').forEach(btn => {
        const m = btn.dataset.material;
        const count = Array.from(scanRows).filter(row => row.cells[2].textContent.includes(m)).length;
        btn.textContent = `${m} (${count})`;
        btn.style.opacity = (count === 0 && !btn.classList.contains('selected')) ? "0.5" : "1";
      });
    };
    
    updateButtonsOutside = updateButtons;

    // ææ–™ãƒœã‚¿ãƒ³ã‚’è¿½åŠ ï¼ˆãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã®å¾Œã«ä¸¦ã³ã¾ã™ï¼‰
    materialList.forEach(name => {
      const btn = document.createElement('button');
      btn.dataset.material = name;
      btn.textContent = name;
      target.appendChild(btn);

      btn.onclick = () => {
        btn.classList.toggle('selected');
        const selectedMaterials = Array.from(target.querySelectorAll('button.selected:not(#favoriteFilterBtn)'))
                                       .map(b => b.dataset.material);

        rows.forEach(row => {
          if (selectedMaterials.length === 0) {
            row.classList.remove('hidden');
          } else {
            const rowText = row.cells[2].textContent;
            const isMatch = selectedMaterials.every(m => rowText.includes(m));
            row.classList.toggle('hidden', !isMatch);
          }
        });
        updateButtons();
      };
    });

    updateButtons();
}

// 1060è¡Œç›®ä»˜è¿‘
function renderRecipes() {
  const tbody = document.querySelector('#recipeTable tbody');
  if (!tbody) return;
  tbody.innerHTML = ""; 

  RECIPE_LIST.forEach(r => {
    const tr = document.createElement('tr');
    tr.dataset.id = r.id;
    tr.innerHTML = `
      <td>${r.id}</td>
      <td class="recipe-name">
        <a href="javascript:void(0);" onclick="goToRecipeDetail('${r.id}')">${r.name}</a>
        <span class="hidden-reading">${r.reading || ''}</span>
      </td>
      <td>${r.materials.map(m => `<span class="material">${m}</span>`).join('')}</td>
      <td data-genre="${r.genre}">${r.genre}</td>
      <td>
        <img id="img${r.id}" src="images/${r.id}.jpg" alt="æ–™ç†ç”»åƒ" onerror="this.src='images/NO_NAME.jpg'">
      </td>
      <td>${r.favorite || ''}</td>
      <td class="match-rate"></td>
    `;
    
    // è¡Œå…¨ä½“ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸæ™‚ã‚‚åŒã˜é–¢æ•°ã‚’å‘¼ã¶
    tr.onclick = (e) => {
      if (e.target.tagName !== 'A') {
        goToRecipeDetail(r.id);
      }
    };
    tbody.appendChild(tr);
  });
}

// ãƒ‡ãƒ¼ã‚¿ã®æç”»ã¨åˆæœŸåŒ–ã®å¸ä»¤å¡”
document.addEventListener('DOMContentLoaded', () => {
  if (typeof RECIPE_LIST !== 'undefined') {
    renderRecipes();            // â‘  ã¾ãšã‚«ãƒ¼ãƒ‰ã‚’å…¨éƒ¨å‡ºã™
    generateMaterialButtons();  // â‘¡ æ¤œç´¢æ©Ÿèƒ½ã‚’æº–å‚™
    filterAndSortRecipes();     // â‘¢ çµã‚Šè¾¼ã¿ã‚’æº–å‚™
    
    // â‘£ æœ€å¾Œã«ã‚ãªãŸã®ã€Œè±šè‚‰ãƒ»é¶è‚‰ã€ãƒœã‚¿ãƒ³ã‚’æº–å‚™ã™ã‚‹
    initFixedMaterialButtons(); 
  } else {
    console.error("recipes_data.js ãŒèª­ã¿è¾¼ã‚ã¦ã„ã¾ã›ã‚“");
  }
});
</script>
</body>
</html>